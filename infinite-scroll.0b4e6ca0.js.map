{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,iEAQMC,EAAa,IAAI,EAAAC,EAAAC,YAEjBC,EAAO,CACXC,KAAMC,SAASC,cAAc,gBAC7BC,MAAOF,SAASC,cAAc,eAC9BE,UAAWH,SAASC,cAAc,eAClCG,QAASJ,SAASC,cAAc,YAChCI,SAAUL,SAASC,cAAc,cAGnCH,EAAKC,KAAKO,iBAAiB,U,SAMKC,G,OAAjBC,EAAgBC,MAAAC,KAAAC,U,IAJ/B,IACIC,EADAC,EAAe,EAEfC,EAAa,E,SAEFN,I,OAAAA,EAAfO,EAAAtB,EAAA,CAAAsB,EAAAC,GAAAC,MAAA,SAAAC,EAAgCX,G,qEAC9BY,EAASC,WAAWtB,EAAKO,UACzBE,EAAMc,iBACN1B,EAAW2B,KAAO,EAClBxB,EAAKM,QAAQmB,UAAY,GAEO,KAA5BzB,EAAKI,MAAMsB,MAAMC,OAAa,C,sBAChCV,EAAAW,GAASC,OAAOC,QACd,wDAEF9B,EAAKI,MAAMsB,MAAQ,G,iCAIrBX,EAAe,EAEflB,EAAWkC,MAAQ/B,EAAKI,MAAMsB,MAAMC,O,oBAGX9B,EAAWmC,c,QAClCC,EADYC,EAAAC,KAAJC,M,2DAMVpC,EAAKI,MAAMsB,MAAQ,GACnBL,EAASgB,QAAQrC,EAAKO,U,4DA1BOI,MAAAC,KAAAC,U,UA6BhByB,I,OAAAA,EAAfrB,EAAAtB,EAAA,CAAAsB,EAAAC,GAAAC,MAAA,SAAAC,I,yEACEN,EAAcyB,U,kBAGW1C,EAAWmC,c,OAClCC,EADYC,EAAAC,KAAJC,M,0GAJgBzB,MAAAC,KAAAC,U,CAW5B,SAASoB,EAAeG,GACH,IAAfA,EAAKI,OAAoC,KAArB3C,EAAWkC,OAOX,IAApBlC,EAAW2B,MAAcY,EAAKK,UAAY,IAC5CxB,EAAAW,GAASC,OAAOa,KAAK,oBAAmCC,OAAfP,EAAKK,UAAU,aACxDzB,EAAaoB,EAAKK,WAGpB5C,EAAW2B,MAAQ,EAqBrB,SAA4BY,GAC1BpC,EAAKM,QAAQsC,mBAAmB,aAAa,EAAAC,EAAAC,SAAkBV,EAAKW,OAEpEhC,GAAgBqB,EAAKW,KAAKC,M,CAtB1BC,CAAmBb,IAEnBtB,EAAgB,IAAIG,EAAAiC,GAAJ,CAAmB,aAAc,CAC/CC,aAAc,OAEFC,UAEVrC,GAAgB,KAClBE,EAAAW,GAASC,OAAOa,KACb,+DAtBHzB,EAAAW,GAASC,OAAOC,QACd,2E,CAqCN,IAYMT,EAAW,IAAIgC,sBAZO,SAAAC,GAC1BA,EAAQC,SAAQ,SAAAC,GAEZA,EAAMC,gBACe,KAArB5D,EAAWkC,OACXhB,EAAeC,G,WAxDNsB,EAAa3B,MAAAC,KAAAC,U,CA0DtB6C,E,MAKyD,CAC7DC,WAAY,UAGdtC,EAASgB,QAAQrC,EAAKO,S","sources":["src/js/infinite-scroll.js"],"sourcesContent":["import imageCardTemplate from '../templates/gallery.hbs';\nimport { PixabayAPI } from './pixabay-API';\n\nimport Notiflix from 'notiflix';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst pixabayApi = new PixabayAPI();\n\nconst refs = {\n  form: document.querySelector('.search-form'),\n  input: document.querySelector('.form-input'),\n  submitBtn: document.querySelector('.search-btn'),\n  gallery: document.querySelector('.gallery'),\n  sentinel: document.querySelector('.sentinel'),\n};\n\nrefs.form.addEventListener('submit', handleSubmitForm);\n\nlet uploadedHits = 0;\nlet modalLightbox;\nlet totalCards = 0;\n\nasync function handleSubmitForm(event) {\n  observer.disconnect(refs.sentinel);\n  event.preventDefault();\n  pixabayApi.page = 1;\n  refs.gallery.innerHTML = '';\n\n  if (refs.input.value.trim() === '') {\n    Notiflix.Notify.failure(\n      'Sorry, your search query is empty. Please try again.'\n    );\n    refs.input.value = '';\n    return;\n  }\n\n  uploadedHits = 0;\n\n  pixabayApi.query = refs.input.value.trim();\n\n  try {\n    const { data } = await pixabayApi.fetchPhotos();\n    onFetchSuccess(data);\n  } catch (error) {\n    onFetchError;\n  }\n\n  refs.input.value = '';\n  observer.observe(refs.sentinel);\n}\n\nasync function loadMoreCards() {\n  modalLightbox.destroy();\n\n  try {\n    const { data } = await pixabayApi.fetchPhotos();\n    onFetchSuccess(data);\n  } catch (error) {\n    onFetchError;\n  }\n}\n\nfunction onFetchSuccess(data) {\n  if (data.total === 0 || pixabayApi.query === '') {\n    Notiflix.Notify.failure(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n    return;\n  }\n\n  if (pixabayApi.page === 1 && data.totalHits > 0) {\n    Notiflix.Notify.info(`Hooray! We found ${data.totalHits} images.`);\n    totalCards = data.totalHits;\n  }\n\n  pixabayApi.page += 1;\n\n  renderGalleryCards(data);\n\n  modalLightbox = new SimpleLightbox('.gallery a', {\n    captionDelay: 250,\n  });\n  modalLightbox.refresh();\n\n  if (uploadedHits >= 500) {\n    Notiflix.Notify.info(\n      `We're sorry, but you've reached the end of search results.`\n    );\n    return;\n  }\n}\n\nfunction onFetchError(error) {\n  console.warn(error);\n}\n\nfunction renderGalleryCards(data) {\n  refs.gallery.insertAdjacentHTML('beforeend', imageCardTemplate(data.hits));\n\n  uploadedHits += data.hits.length;\n}\n\nconst intersectionObserve = entries => {\n  entries.forEach(entry => {\n    if (\n      entry.isIntersecting &&\n      pixabayApi.query !== '' &&\n      uploadedHits < totalCards\n    ) {\n      loadMoreCards();\n    }\n  });\n};\n\nconst observer = new IntersectionObserver(intersectionObserve, {\n  rootMargin: '200px',\n});\n\nobserver.observe(refs.sentinel);\n"],"names":["$bpxeT","parcelRequire","$93b54f497d416715$var$pixabayApi","$ckYVG","PixabayAPI","$93b54f497d416715$var$refs","form","document","querySelector","input","submitBtn","gallery","sentinel","addEventListener","event","$93b54f497d416715$var$_handleSubmitForm","apply","this","arguments","$93b54f497d416715$var$modalLightbox","$93b54f497d416715$var$uploadedHits","$93b54f497d416715$var$totalCards","$parcel$interopDefault","$2TvXO","mark","_callee","$93b54f497d416715$var$observer","disconnect","preventDefault","page","innerHTML","value","trim","$6JpON","Notify","failure","query","fetchPhotos","$93b54f497d416715$var$onFetchSuccess","_ctx","sent","data","observe","$93b54f497d416715$var$_loadMoreCards","destroy","total","totalHits","info","concat","insertAdjacentHTML","$1zY8r","default","hits","length","$93b54f497d416715$var$renderGalleryCards","$5IjG7","captionDelay","refresh","IntersectionObserver","entries","forEach","entry","isIntersecting","$93b54f497d416715$var$loadMoreCards","rootMargin"],"version":3,"file":"infinite-scroll.0b4e6ca0.js.map"}