{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,uCAQA,MAAMC,EAAa,IAAI,EAAAC,EAAAC,YAEjBC,EAAO,CACXC,KAAMC,SAASC,cAAc,gBAC7BC,MAAOF,SAASC,cAAc,eAC9BE,UAAWH,SAASC,cAAc,eAClCG,QAASJ,SAASC,cAAc,YAChCI,QAASL,SAASC,cAAc,eAGlCH,EAAKC,KAAKO,iBAAiB,UAM3BC,eAAgCC,GAG9B,GAFAA,EAAMC,iBACNX,EAAKM,QAAQM,UAAY,GACO,KAA5BZ,EAAKI,MAAMS,MAAMC,OAKnB,OAJAC,EAAAC,GAASC,OAAOC,QACd,6DAEFlB,EAAKI,MAAMS,MAAQ,IAGrBM,EAAe,EACftB,EAAWuB,KAAO,EAClBvB,EAAWwB,MAAQrB,EAAKI,MAAMS,MAAMC,OAEpC,IACE,MAAMQ,KAAEA,SAAezB,EAAW0B,cAClCC,EAAeF,E,CACf,MAAOG,G,CAITzB,EAAKI,MAAMS,MAAQ,E,IA1BrBb,EAAKO,QAAQC,iBAAiB,SA6B9BC,iBACEiB,EAAcC,UAEd,IACE,MAAML,KAAEA,SAAezB,EAAW0B,cAClCC,EAAeF,E,CACf,MAAOG,G,CAIT,MAAQG,OAAQC,GACd7B,EAAKM,QAAQwB,kBAAkBC,wBAEjCC,OAAOC,SAAS,CACdC,IAAkB,IAAbL,EACLM,SAAU,U,IA1Cd,IACIT,EADAP,EAAe,EA8CnB,SAASK,EAAeF,GACtB,OAAmB,IAAfA,EAAKc,OAAoC,KAArBvC,EAAWwB,OACjCN,EAAAC,GAASC,OAAOC,QACd,iFAEFlB,EAAKO,QAAQ8B,UAAUC,IAAI,eAIL,IAApBzC,EAAWuB,MAAcE,EAAKiB,UAAY,GAC5CxB,EAAAC,GAASC,OAAOuB,KAAK,oBAAoBlB,EAAKiB,qBAEhD1C,EAAWuB,MAAQ,EA6BrB,SAA4BE,GAC1BtB,EAAKM,QAAQmC,mBAAmB,aAAa,EAAA9C,EAAA+C,SAAkBpB,EAAKqB,OAEpExB,GAAgBG,EAAKqB,KAAKC,OAC1B5C,EAAKO,QAAQ8B,UAAUQ,OAAO,Y,CA/B9BC,CAAmBxB,GAEnBI,EAAgB,IAAIX,EAAAgC,GAAJ,CAAmB,aAAc,CAC/CC,aAAc,MAEhBtB,EAAcuB,UAEV9B,GAAgB,KAClBnB,EAAKO,QAAQ8B,UAAUC,IAAI,kBAC3BvB,EAAAC,GAASC,OAAOuB,KACd,oEAKAlB,EAAKiB,YAAcpB,GAAgBG,EAAKiB,UAAY,IACtDvC,EAAKO,QAAQ8B,UAAUC,IAAI,aAC3BvB,EAAAC,GAASC,OAAOuB,KACd,gE","sources":["src/index.js"],"sourcesContent":["import imageCardTemplate from './templates/gallery.hbs';\nimport { PixabayAPI } from './js/pixabay-API';\n\nimport Notiflix from 'notiflix';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst pixabayApi = new PixabayAPI();\n\nconst refs = {\n  form: document.querySelector('.search-form'),\n  input: document.querySelector('.form-input'),\n  submitBtn: document.querySelector('.search-btn'),\n  gallery: document.querySelector('.gallery'),\n  loadBtn: document.querySelector('.load-more'),\n};\n\nrefs.form.addEventListener('submit', handleSubmitForm);\nrefs.loadBtn.addEventListener('click', handleLoadMoreBtn);\n\nlet uploadedHits = 0;\nlet modalLightbox;\n\nasync function handleSubmitForm(event) {\n  event.preventDefault();\n  refs.gallery.innerHTML = '';\n  if (refs.input.value.trim() === '') {\n    Notiflix.Notify.failure(\n      'Sorry, your search query is empty. Please try again.'\n    );\n    refs.input.value = '';\n    return;\n  }\n  uploadedHits = 0;\n  pixabayApi.page = 1;\n  pixabayApi.query = refs.input.value.trim();\n\n  try {\n    const { data } = await pixabayApi.fetchPhotos();\n    onFetchSuccess(data);\n  } catch (error) {\n    onFetchError;\n  }\n\n  refs.input.value = '';\n}\n\nasync function handleLoadMoreBtn() {\n  modalLightbox.destroy();\n\n  try {\n    const { data } = await pixabayApi.fetchPhotos();\n    onFetchSuccess(data);\n  } catch (error) {\n    onFetchError;\n  }\n\n  const { height: cardHeight } =\n    refs.gallery.firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 1.8,\n    behavior: 'smooth',\n  });\n}\n\nfunction onFetchSuccess(data) {\n  if (data.total === 0 || pixabayApi.query === '') {\n    Notiflix.Notify.failure(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n    refs.loadBtn.classList.add('is-hidden');\n    return;\n  }\n\n  if (pixabayApi.page === 1 && data.totalHits > 0) {\n    Notiflix.Notify.info(`Hooray! We found ${data.totalHits} images.`);\n  }\n  pixabayApi.page += 1;\n\n  renderGalleryCards(data);\n\n  modalLightbox = new SimpleLightbox('.gallery a', {\n    captionDelay: 250,\n  });\n  modalLightbox.refresh();\n\n  if (uploadedHits >= 500) {\n    refs.loadBtn.classList.add('is-hidden');\n    Notiflix.Notify.info(\n      `We're sorry, but you've reached the end of search results.`\n    );\n    return;\n  }\n\n  if (data.totalHits === uploadedHits && data.totalHits > 0) {\n    refs.loadBtn.classList.add('is-hidden');\n    Notiflix.Notify.info(\n      `We're sorry, but you've reached the end of search results.`\n    );\n  }\n}\n\nfunction onFetchError(error) {\n  console.warn(error);\n}\n\nfunction renderGalleryCards(data) {\n  refs.gallery.insertAdjacentHTML('beforeend', imageCardTemplate(data.hits));\n\n  uploadedHits += data.hits.length;\n  refs.loadBtn.classList.remove('is-hidden');\n}\n"],"names":["$4TmbC","parcelRequire","$1f0dc3b9307be026$var$pixabayApi","$dgPer","PixabayAPI","$1f0dc3b9307be026$var$refs","form","document","querySelector","input","submitBtn","gallery","loadBtn","addEventListener","async","event","preventDefault","innerHTML","value","trim","$parcel$interopDefault","$7Y9D8","Notify","failure","$1f0dc3b9307be026$var$uploadedHits","page","query","data","fetchPhotos","$1f0dc3b9307be026$var$onFetchSuccess","error","$1f0dc3b9307be026$var$modalLightbox","destroy","height","cardHeight","firstElementChild","getBoundingClientRect","window","scrollBy","top","behavior","total","classList","add","totalHits","info","insertAdjacentHTML","default","hits","length","remove","$1f0dc3b9307be026$var$renderGalleryCards","$fZKcF","captionDelay","refresh"],"version":3,"file":"index.8ba2c573.js.map"}