{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,iEAQMC,EAAa,IAAI,EAAAC,EAAAC,YAEjBC,EAAO,CACXC,KAAMC,SAASC,cAAc,gBAC7BC,MAAOF,SAASC,cAAc,eAC9BE,UAAWH,SAASC,cAAc,eAClCG,QAASJ,SAASC,cAAc,YAChCI,QAASL,SAASC,cAAc,eAGlCH,EAAKC,KAAKO,iBAAiB,U,SAMKC,G,OAAjBC,EAAgBC,MAAAC,KAAAC,U,IAL/Bb,EAAKO,QAAQC,iBAAiB,S,kBA6BfM,EAAiBH,MAAAC,KAAAC,U,IA3BhC,IACIE,EADAC,EAAe,E,SAGJN,I,OAAAA,EAAfO,EAAAtB,EAAA,CAAAsB,EAAAC,GAAAC,MAAA,SAAAC,EAAgCX,G,qEAC9BA,EAAMY,iBACNrB,EAAKM,QAAQgB,UAAY,GACO,KAA5BtB,EAAKI,MAAMmB,MAAMC,OAAa,C,sBAChCP,EAAAQ,GAASC,OAAOC,QACd,wDAEF3B,EAAKI,MAAMmB,MAAQ,G,iCAGrBP,EAAe,EACfnB,EAAW+B,KAAO,EAClB/B,EAAWgC,MAAQ7B,EAAKI,MAAMmB,MAAMC,O,mBAGX3B,EAAWiC,c,QAClCC,EADYC,EAAAC,KAAJC,M,0DAMVlC,EAAKI,MAAMmB,MAAQ,G,2DArBUZ,MAAAC,KAAAC,U,UAwBhBC,I,OAAAA,EAAfG,EAAAtB,EAAA,CAAAsB,EAAAC,GAAAC,MAAA,SAAAC,I,IAWIe,EADcC,E,yEAThBrB,EAAcsB,U,kBAGWxC,EAAWiC,c,OAClCC,EADYC,EAAAC,KAAJC,M,wDAORC,EAAAnC,EAAKM,QAAQgC,kBAAkBC,wBADzBH,EACND,EADMK,OAGRC,OAAOC,SAAS,CACdC,IAAkB,IAAbP,EACLQ,SAAU,W,0DAfkBjC,MAAAC,KAAAC,U,CAmBhC,SAASkB,EAAeG,GACtB,OAAmB,IAAfA,EAAKW,OAAoC,KAArBhD,EAAWgC,OACjCZ,EAAAQ,GAASC,OAAOC,QACd,iFAEF3B,EAAKO,QAAQuC,UAAUC,IAAI,eAIL,IAApBlD,EAAW+B,MAAcM,EAAKc,UAAY,GAC5C/B,EAAAQ,GAASC,OAAOuB,KAAK,oBAAmCC,OAAfhB,EAAKc,UAAU,aAE1DnD,EAAW+B,MAAQ,EA6BrB,SAA4BM,GAC1BlC,EAAKM,QAAQ6C,mBAAmB,aAAa,EAAAC,EAAAC,SAAkBnB,EAAKoB,OAEpEtC,GAAgBkB,EAAKoB,KAAKC,OAC1BvD,EAAKO,QAAQuC,UAAUU,OAAO,Y,CA/B9BC,CAAmBvB,IAEnBnB,EAAgB,IAAIE,EAAAyC,GAAJ,CAAmB,aAAc,CAC/CC,aAAc,OAEFC,UAEV5C,GAAgB,KAClBhB,EAAKO,QAAQuC,UAAUC,IAAI,kBAC3B9B,EAAAQ,GAASC,OAAOuB,KACb,oEAKDf,EAAKc,YAAchC,GAAgBkB,EAAKc,UAAY,IACtDhD,EAAKO,QAAQuC,UAAUC,IAAI,aAC3B9B,EAAAQ,GAASC,OAAOuB,KACb,gE","sources":["src/index.js"],"sourcesContent":["import imageCardTemplate from './templates/gallery.hbs';\nimport { PixabayAPI } from './js/pixabay-API';\n\nimport Notiflix from 'notiflix';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst pixabayApi = new PixabayAPI();\n\nconst refs = {\n  form: document.querySelector('.search-form'),\n  input: document.querySelector('.form-input'),\n  submitBtn: document.querySelector('.search-btn'),\n  gallery: document.querySelector('.gallery'),\n  loadBtn: document.querySelector('.load-more'),\n};\n\nrefs.form.addEventListener('submit', handleSubmitForm);\nrefs.loadBtn.addEventListener('click', handleLoadMoreBtn);\n\nlet uploadedHits = 0;\nlet modalLightbox;\n\nasync function handleSubmitForm(event) {\n  event.preventDefault();\n  refs.gallery.innerHTML = '';\n  if (refs.input.value.trim() === '') {\n    Notiflix.Notify.failure(\n      'Sorry, your search query is empty. Please try again.'\n    );\n    refs.input.value = '';\n    return;\n  }\n  uploadedHits = 0;\n  pixabayApi.page = 1;\n  pixabayApi.query = refs.input.value.trim();\n\n  try {\n    const { data } = await pixabayApi.fetchPhotos();\n    onFetchSuccess(data);\n  } catch (error) {\n    onFetchError;\n  }\n\n  refs.input.value = '';\n}\n\nasync function handleLoadMoreBtn() {\n  modalLightbox.destroy();\n\n  try {\n    const { data } = await pixabayApi.fetchPhotos();\n    onFetchSuccess(data);\n  } catch (error) {\n    onFetchError;\n  }\n\n  const { height: cardHeight } =\n    refs.gallery.firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 1.8,\n    behavior: 'smooth',\n  });\n}\n\nfunction onFetchSuccess(data) {\n  if (data.total === 0 || pixabayApi.query === '') {\n    Notiflix.Notify.failure(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n    refs.loadBtn.classList.add('is-hidden');\n    return;\n  }\n\n  if (pixabayApi.page === 1 && data.totalHits > 0) {\n    Notiflix.Notify.info(`Hooray! We found ${data.totalHits} images.`);\n  }\n  pixabayApi.page += 1;\n\n  renderGalleryCards(data);\n\n  modalLightbox = new SimpleLightbox('.gallery a', {\n    captionDelay: 250,\n  });\n  modalLightbox.refresh();\n\n  if (uploadedHits >= 500) {\n    refs.loadBtn.classList.add('is-hidden');\n    Notiflix.Notify.info(\n      `We're sorry, but you've reached the end of search results.`\n    );\n    return;\n  }\n\n  if (data.totalHits === uploadedHits && data.totalHits > 0) {\n    refs.loadBtn.classList.add('is-hidden');\n    Notiflix.Notify.info(\n      `We're sorry, but you've reached the end of search results.`\n    );\n  }\n}\n\nfunction onFetchError(error) {\n  console.warn(error);\n}\n\nfunction renderGalleryCards(data) {\n  refs.gallery.insertAdjacentHTML('beforeend', imageCardTemplate(data.hits));\n\n  uploadedHits += data.hits.length;\n  refs.loadBtn.classList.remove('is-hidden');\n}\n"],"names":["$bpxeT","parcelRequire","$b8f9b7833fa37166$var$pixabayApi","$ckYVG","PixabayAPI","$b8f9b7833fa37166$var$refs","form","document","querySelector","input","submitBtn","gallery","loadBtn","addEventListener","event","$b8f9b7833fa37166$var$_handleSubmitForm","apply","this","arguments","$b8f9b7833fa37166$var$_handleLoadMoreBtn","$b8f9b7833fa37166$var$modalLightbox","$b8f9b7833fa37166$var$uploadedHits","$parcel$interopDefault","$2TvXO","mark","_callee","preventDefault","innerHTML","value","trim","$6JpON","Notify","failure","page","query","fetchPhotos","$b8f9b7833fa37166$var$onFetchSuccess","_ctx","sent","data","ref","cardHeight","destroy","firstElementChild","getBoundingClientRect","height","window","scrollBy","top","behavior","total","classList","add","totalHits","info","concat","insertAdjacentHTML","$1zY8r","default","hits","length","remove","$b8f9b7833fa37166$var$renderGalleryCards","$5IjG7","captionDelay","refresh"],"version":3,"file":"index.8b2a7ab6.js.map"}